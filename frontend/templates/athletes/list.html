{% extends "base.html" %}

{% block title %}Спортсмены - BJJ Rating{% endblock %}

{% block content %}
<div class="table-responsive">
  <table class="table table-striped table-hover">
    <thead class="table-dark">
    <tr>
      <th>Место</th>
      <th>Имя</th>
      <th>Город</th>
      <th>Регион</th>
      <th>Очки</th>
      <th>Действия</th>
    </tr>
    </thead>
    <tbody>
    {% for athlete in athletes %}
    <tr>
      <td>
        <div class="ranking-badge {% if athlete.place == 1 %}ranking-1{% elif athlete.place == 2 %}ranking-2{% elif athlete.place == 3 %}ranking-3{% else %}ranking-other{% endif %}">
          {{ athlete.place }}
        </div>
      </td>
      <td>
        <a href="#"
           hx-get="/athletes/{{ athlete.id }}"
           hx-target="main"
           hx-push-url="true">
          {{ athlete.fullname }}
        </a>
      </td>
      <td>{{ athlete.city }}</td>
      <td>{{ athlete.region }}</td>
      <td>
        <span class="badge bg-primary">{{ athlete.points }}</span>
      </td>
      <td>
        <button class="btn btn-sm btn-outline-primary"
                hx-get="/athletes/{{ athlete.id }}"
                hx-target="main"
                hx-push-url="true">
          <i class="fas fa-eye"></i>
        </button>
        {% if user and user.is_admin %}
        <button class="btn btn-sm btn-outline-warning"
                hx-get="/api/v1/athletes/{{ athlete.id }}/edit"
                hx-target="main">
          <i class="fas fa-edit"></i>
        </button>
        <button class="btn btn-sm btn-outline-danger"
                hx-delete="/api/v1/athletes/{{ athlete.id }}"
                hx-confirm="Удалить спортсмена?">
          <i class="fas fa-trash"></i>
        </button>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>

<!-- Pagination -->
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    {% if offset > 0 %}
    <li class="page-item">
      <a class="page-link"
         hx-get="/api/v1/athletes?offset={{ offset - limit }}&limit={{ limit }}"
         hx-target="#athletes-table">
        Назад
      </a>
    </li>
    {% endif %}

    {% if athletes|length == limit %}
    <li class="page-item">
      <a class="page-link"
         hx-get="/api/v1/athletes?offset={{ offset + limit }}&limit={{ limit }}"
         hx-target="#athletes-table">
        Вперед
      </a>
    </li>
    {% endif %}
  </ul>
</nav>
{% endblock %}