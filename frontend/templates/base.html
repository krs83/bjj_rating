<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Рейтинг спортсменов</title>
    <link href="/static/css/styles.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js" integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous" />
  </head>
  <body hx-headers='{"X-Requested-With": "XMLHttpRequest"}' hx-target="body"  hx-history="cache" hx-boost="true">
    <!-- Header -->
    {% include "/components/header.html" %}

    <!-- Main Content -->
    <main class="container-fluid py-4">
      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    {% include "/components/footer.html" %}

    <!-- Toast Container for Notifications -->
    <div id="toast-container" class="toast-container position-fixed top-0 end-0 p-3"></div>

    <!-- Loading Spinner -->
    <div id="loading-spinner" class="d-none">
      <div class="spinner-overlay">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    </div>

    <script src="/static/js/app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

    <script>
      // Простейший фикс - переинициализация HTMX после загрузки контента
      document.addEventListener('htmx:afterSwap', function() {
        // HTMX автоматически обрабатывает новые элементы
        // благодаря hx-boost и hx-target на body
      });
    </script>

    <script>
      console.log("=== HTMX DEBUG ===");
      console.log("HTMX version:", htmx.version);
      console.log("Body hx-target:", document.body.getAttribute('hx-target'));

      // Проверка всех ссылок с пагинацией
      document.addEventListener('click', function(e) {
        if (e.target.closest('.page-link')) {
          console.log("=== CLICK ON PAGINATION ===");
          console.log("Target element:", e.target);
          console.log("Has hx-get:", e.target.hasAttribute('hx-get'));
          console.log("Parent has hx-get:", e.target.closest('[hx-get]'));
          console.log("Href:", e.target.getAttribute('href') || e.target.closest('a').getAttribute('href'));
          e.preventDefault(); // Чтобы не уходило сразу
        }
      });
    </script>
  </body>
</html>
